# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–∫—É–ø–∫–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω–µ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 90 –¥–Ω–µ–π.


##  –û–ø–∏—Å–∞–Ω–∏–µ
–ü—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â—ë–Ω –∞–Ω–∞–ª–∏–∑—É –ø–æ–≤–µ–¥–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 90 –¥–Ω–µ–π –ø–æ—Å–ª–µ —Ä–µ–∫–ª–∞–º–Ω–æ–π —Ä–∞—Å—Å—ã–ª–∫–∏.  

–í —Ä–∞–º–∫–∞—Ö —Ä–∞–±–æ—Ç—ã:
- –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–∫—É–ø–∫–∞—Ö, —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –∏ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.  
- –ü—Ä–æ–≤–µ–¥—ë–Ω EDA: –∞–Ω–∞–ª–∏–∑ –ø–æ–∫—É–ø–æ–∫, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏, –∫–∞–Ω–∞–ª–æ–≤ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–º–ø–∞–Ω–∏–π.  
- –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏.  
- –û–±—É—á–µ–Ω–∞ –º–æ–¥–µ–ª—å CatBoost –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏.  

---

##  –î–∞–Ω–Ω—ã–µ
–î–∞—Ç–∞—Å–µ—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö —á–∞—Å—Ç–µ–π:
1. **Purchases** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∫—É–ø–∫–∞—Ö (–∫–ª–∏–µ–Ω—Ç, –¥–∞—Ç–∞, —Ü–µ–Ω–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏).  
2. **Messages** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ä–∞—Å—Å—ã–ª–∫–∞—Ö (–∫–∞–Ω–∞–ª, —Å–æ–±—ã—Ç–∏–µ, –¥–∞—Ç–∞).  
3. **Target** ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π —Ç–∞—Ä–≥–µ—Ç (–ø–æ–∫—É–ø–∫–∞ / –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–∫—É–ø–∫–∏).  

–†–∞–∑–º–µ—Ä –∏—Ç–æ–≥–æ–≤–æ–≥–æ –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞: **‚âà 490k –∑–∞–ø–∏—Å–µ–π**, **37 545 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**, **1 526 —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π**.  

---

##  EDA ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã
- **–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤**: –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ, —á–µ–º –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö.  
- **–¶–µ–Ω—ã**: –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –¥–æ 100 ‚ÇΩ, —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å —Ç—è–∂—ë–ª—ã–º –ø—Ä–∞–≤—ã–º —Ö–≤–æ—Å—Ç–æ–º.  
- **–ö–∞–º–ø–∞–Ω–∏–∏**: —Å —Ä–æ—Å—Ç–æ–º –º–∞—Å—à—Ç–∞–±–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç, –Ω–æ –µ—Å—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è.  
- **–ö–∞–Ω–∞–ª—ã**: email –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–∞—â–µ, –Ω–æ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ª—É—á—à—É—é –∫–æ–Ω–≤–µ—Ä—Å–∏—é.  
- **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**: –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –ø–∏–∫–∏ –∑–∞–∫–∞–∑–æ–≤ –≤ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã.  

---

## üõ† Feature Engineering
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏:  
- **–ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ**: `total_sum`, `recency`, `frequency`, `monetary`.  
- **–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å**: –º–µ—Å—è—Ü, –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏, —á–∞—Å –ø–æ–∫—É–ø–∫–∏.  
- **–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã–µ**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (`num_interactions`), –ø–æ –∫–∞–Ω–∞–ª–∞–º (`num_email`, `num_push`).  
- **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ**: –≤—ã–¥–µ–ª–µ–Ω—ã —É—Ä–æ–≤–Ω–∏ –∏–∑ `category_ids`.  
- **–õ–æ–≥-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**: `log_price`, `log_total_sum`.  

---

##  –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è **CatBoostClassifier**.  

–õ—É—á—à–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:  
depth=10, iterations=400, learning_rate=0.08,
l2_leaf_reg=0.1, subsample=0.7, rsm=0.8,
grow_policy=SymmetricTree, border_count=128,
class_weights=[1,2]

### –ú–µ—Ç—Ä–∏–∫–∏:
- **ROC AUC (train):** 0.993  
- **ROC AUC (CV):** 0.978  
- **ROC AUC (test):** 0.983  
- **Average Precision (AP):** 0.883  

–ú–æ–¥–µ–ª—å –ø–æ–∫–∞–∑–∞–ª–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å (—Ä–∞–∑–Ω–∏—Ü–∞ train/test –º–∏–Ω–∏–º–∞–ª—å–Ω–∞), –∞ —Ç–∞–∫–∂–µ —Å–º–µ—â–µ–Ω–∏–µ –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤—ã—Å–æ–∫–æ–π precision, —á—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.  

---

##  –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:
- `total_sum` (—Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞),  
- `purchase_month`, `purchase_dayofweek` (—Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å),  
- `num_interactions` (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏),  
- `price`, `category_ids`, `third_cat`.  

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/LUDVIG-BAISER/workshop_2.git
cd workshop_2

# 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv

# 3. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
# Linux / macOS
source venv/bin/activate
# Windows
venv\Scripts\activate

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å Jupyter Notebook –∏–ª–∏ Jupyter Lab
jupyter notebook
# –∏–ª–∏
jupyter lab
